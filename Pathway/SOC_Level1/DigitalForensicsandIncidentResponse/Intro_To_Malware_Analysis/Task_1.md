Task 2
Malware analysis is performed by the following people. 
Security operations: 
Incident Response: 
Threat Hunt: 
Malware Researchers
Threat Research: 

Take the following precautions while analyzing malware
- Never analyze malware or suspected malware on a machine that does not have the sole purpose of analyzing malware. 
- When not analyzing or moving malware samples around to different locations, always keep them in password-protected zip/rar or other archives so that we can avoid accidental detonation.
- Only extract the malware from this password-protected archive inside the isolated environment, and only when analyzing it
- Create an isolated VM specifically for malware analysis, which can be reverted to a clean slate once you are done. 
- Ensure that all internet connections are closed or at least monitored
- Once you're done with malware analysis, revert the VM to its clean slate for the next malware analysis session to avoid residue from a previous malware execution corrupting the next one. 

Question 1: Which team uses malware analysis to look for IOCs and hunt for malware in a network?

Answer: Threat Hunt team

Task 3
- Executable file, also called a binary or PE(Portable Executable).


Static Analysis
When malware is analyzed without being executed, it is called static Analysis. In this case, the different properties of the PE file are analyzed without running it.
Ex checking for strings, checking PE header for information related to different sections, or dissembling code. 

Dynamic Analysis
Running malware to detect it. 
Run the malware in a VM, either in a manual fashion with tools installed to monitor the malware's activity or in the form of sandboxes that perform this task automatically. 

Advanced Malware Analysis
are used to analyze malware that evades basic static and dynamic analysis. For performing advanced malware analysis, disassemblers and debuggers are used. 
Disassemblers convert the malware's code from binary to assembly so that an analyst can look at the instructions of the malware statically. 
Debuggers attach to a program and allow the analyst to monitor the instructions in malware while it is running. A debugger allows the analyst to stop and run the malware at different points to identify interesting pieces of information while also providing an overview of the memory and CPU of the system. 


Question 1: Which technique is used for analyzing malware without executing it?
See notes above. 

Answer: Static Analysis

Question 2: Which technique is used for analyzing malware by executing it and observing its behavior in a controlled environment?
See notes above. 
Answer Dynamic Analysis


Task 4 Basic Static Analysis
The first step is to perform basic static analysis; this can be considered sizing up the malware, trying to find its properties before diving deep into the analysis. 

Examine file type. 
- file: The command can be used to understand what the file does. 
- Strings: The command will list the present strings in a file. 

Calculating Hashes

Question 1: In the attached VM, there is a sample named 'redline' in the Desktop/Samples directory. What is the md5sum of this sample?
Linux command: md5sum /home/ubuntu/Desktop/Samples/redline

Answer: ca2dc5a3f94c4f19334cc8b68f256259

Question 2: What is the creation time of this sample?
Search the MD5 hash that was just created on VirusTotal, and look in the details tab to find the answer. 

Answer: 2020-08-01 02:44:18 UTC

Task 5: 

PE Header contains the metadata about a Portable Executable file. 
Common PE sections
- .text: this section generally contains the CPU instructions executed when the PE file is run. This section is marked as executable
- .data This section contains the global variables and other global data the PE file uses. 
- .rsrc This section contains resources that are used by the PE file, for example, images, icons, etc. 

pecheck utility to check the PE header. 


Question 1: In the attached VM, there is a sample named 'redline' in the directory Desktop/Samples. What is the entropy of the .text section of this sample?
https://github.com/Shawn-Nichol/TryHackMe/blob/main/Pathway/SOC_Level1/DigitalForensicsandIncidentResponse/Intro_To_Malware_Analysis/Task_1

Answer: 6.453919

Question 2: The sample named 'redline' has five sections. .text, .rdata, .data and .rsrc are four of them. What is the name of the fifth section?
![image](https://github.com/Shawn-Nichol/TryHackMe/assets/30714313/9971e71a-6f47-49da-a49f-614ff42ce811)
Answer: .ndata

Question 3: From which dll file does the sample named 'redline' import the RegOpenKeyExW function?
![image](https://github.com/Shawn-Nichol/TryHackMe/assets/30714313/6ae1fa77-8ff8-4ff6-95c3-cf22a8044d3c)

Answer: ADVAPI32.dll


Task 6
Online sandboxes
- Online Cuckoo Sandbox
- Online CAPE Sandbox
- Any.run
- Intezer
- Hybrid Analysis


Question 1: Check the hash of the sample 'redline' on Hybrid analysis and check out the report generated on 9 Dec 2022. Check the Incident Response section of the report.  How many domains were contacted by the sample?
Do control F and type Domain. 

Answer 17


In the report mentioned above, a text file is accessed by the sample. What is the name of that text file?
Control F and type .txt to find the file. 

Answer: fj4ghga23_fsa.txt

Task 7
Sandbox evasion
- Long sleep class: Malware  is programmed not to perform any activity for a long time after execution.
- UserActivity detection: Some malware will wait for user activity before performing malicious activity.
- Footprintg user Activity: Some malware checks for user files or activity, like if there are any files in the MS Office history or internet browsing history. If no or little activity is found, the mwlare will consider the machine as a sandbox.
- Detecting VMs VM leaves artifacts that can be identified by malware.


Question 1: Which of the techniques discussed above is used to bypass static analysis?

Answer: Packing

Question 2: Which technique discussed above is used to time out a sandbox?

Answer: Long sleep calls


Task 8 
what was learned: 


Static and Dynamic analysis of malware
Finding strings, calculating hashes, and running AV scans on malware
Introduction to the PE header and how to use information from it in malware analysis
Sandboxing and different online sandboxes that we can use
How malware evades the techniques we just discussed.
